# 设计手册
## 功能描述
### 代码生成
1. 整个文件自动生成
2. parameter 自动生成
3. io 接口自动生成
4. 模块自动例化
5. 模块接口自动生成并赋值 (parameter 全都写在 module 开头的 #() 中, 模块接口变量可控制全部生成在内部或外部或部分在外部)
6. 删除自动生成代码
7. 代码按变量名自动排序 (不重要, 尽量还是按模块名排序, 同个模块的变量按定义顺序排序)
8. 各类正则表达式 (可以根据例化名字自动连线, 可以匹配多个例化名与多个例化变量)
9. 数据类型自动补全 (int/integer) (unsigned)
### 格式处理
1. 自动对齐
2. 删除文件尾多余空行
3. 删除行尾多余空格
4. 将文件转换为 unix 格式 (防止出现 ^M 乱码)
### 人工要求
1. 每一列的数据位置需要正确
2. verilog 的文件名需要跟模块名对应
3. 不能写 *xlsx, 要写 *.xlsx

## 程序流程
1. 读入文件列表和控制位 (t)
2. 读入 Excel 并存储为原始表格
	* 控制读取 Excel 文件的列范围 (t)
	* 将数据转换为字符串 (t)
	* 列重命名 (t)
	* 将不适用的 box 置为 0 (t)
3. 数据检测
	1. 去除空行 (t)
	2. 检测不合格数据 (t)
	3. 如果存在不合格数据, 打印信息并退出程序 (t)
	备注:
		* 列名可以修改, 但各列位置必须不动 (只能靠人工保证) (t)
		* 不合格数据: 
			* 模块 port 相关数据:
				1. 在必须出现数据的地方没有出现数据 (error) (t)
				2. 在某一列中出现了不属于该列的数据形式 (error) (t)
				3. 在无效地方出现数据 (warning) (x)
			* 链接表相关数据:
				1. 在不该出现数据的地方出现了数据 (warning) (x)
				2. 没有找到子模块名对应的模块 port (error) (x)
				3. 子模块例化格式错误, 如缺少'--' (error) (t)
				4. 子模块特定连线原变量名字错误, 如变量不属于该子模块 port (warning) (x)
			* 正则表达式相关数据:
				1. 在不该出现数据的地方出现了数据 (warning) (x)
				2. 在必须出现数据的地方没有出现数据 (error) (t)
				2. 正则表达式格式错误, 如缺少'--', 或者正则表达式没法被 re 库识别 (error) (t)
			* verilog 模块缺少定义的 excel (t)
4. 数据整理
	所有模块的信息存储在一个类中，类有多个属性，对应多个方法。属性包括: 
		* 模块名
		* 模块的 verilog 文件类型
		* 模块 port 定义表
		* 模块 parameter 定义表
		* 模块 input/output/inout 等定义表 (分成三个表)
		* 模块内部变量表 (包括 loacalparam 和 local variable)
		* 模块 localparam 定义表
		* 模块 local variable 定义表
		* 子模块例化列表 (子模块名, 例化名, 模块 through out, parameter 链接, port 链接, 变量 through out) (文件, 模块的 through out 最终都落实到变量的 through out 中)
		* 正则表达式表 (子模块名正则表达式, 例化名正则表达式, 子模块 port 名正则表达式, 子模块 port 例化名正则表达式)
	方法包括: 
		1. 遍历 port 或 parameter 或 input/output/inout 或 localparam 或 local variable 定义表, 返回各属性的列表组合成的列表 
		2. 输入子模块名和例化名, 返回子模块的 port 定义表和 parameter 定义表
		3. 根据子模块名和例化名和链接表, 遍历子模块, 返回各属性的列表组合成的列表
	类外方法
		1. 找出一个字符串列表的中字符串的最大长度
		2. 
5. 生成文件

## 未解决的问题
如何确定正则表达式的行数?
